import{eM as r,eN as l,cE as m,bM as f}from"./index-wmwbL88i.js";async function d(e,s){return await e({method:"eth_getStorageAt",params:[s.address,s.position,s.blockTag??"latest"]})}function p(e){if(e.startsWith("0x")||(e=`0x${e}`),e.startsWith("0x363d3d373d3d3d363d73"))return`0x${e.slice(22,62)}`;if(e.startsWith("0x36603057343d5230"))return`0x${e.slice(122,162)}`;if(e.startsWith("0x3d3d3d3d363d3d37363d73"))return`0x${e.slice(24,64)}`;if(e.startsWith("0x366000600037611000600036600073"))return`0x${e.slice(32,72)}`;if(e.startsWith("0x36600080376020600036600073"))return`0x${e.slice(28,68)}`;if(e.startsWith("0x365f5f375f5f365f73"))return`0x${e.slice(20,60)}`}const o="0x0000000000000000000000000000000000000000",c="0x0000000000000000000000000000000000000000000000000000000000000000";async function y(e){const[s,a]=await Promise.all([r(e),u(e)]),i=p(s);if(i)return{address:i,bytecode:await r({...e,address:i})};let t;if(a&&a!==o?(e={...e,address:a},t=await g(e)):t=await x(e),t&&l(t)&&t!==o){const n=await r({...e,address:t});return n==="0x"?{address:e.address,bytecode:s}:{address:t,bytecode:n}}return{address:e.address,bytecode:s}}async function u(e){const s=m({client:e.client,chain:e.chain});try{return`0x${(await d(s,{address:e.address,position:"0xa3f0ad74e5423aebfd80d3ef4346578335a9a72aeaee59ff6cb3582b35133d50"})).slice(-40)}`}catch{return}}async function x(e){const s=m({client:e.client,chain:e.chain});try{const a=[d(s,{address:e.address,position:"0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc"}),d(s,{address:e.address,position:"0xbaab7dbf64751104133af04abc7d9979f0fda3b059a322a8333f533d3f32bf7f"}),d(s,{address:e.address,position:"0x7050c9e0f4ca769c69bd3a8ef740bc37934f8e2c036e5a723fd8ee048ed3f8c3"})],t=(await Promise.all(a)).find(n=>n!==c);return t?`0x${t.slice(-40)}`:o}catch{return}}const A={type:"function",name:"implementation",inputs:[],outputs:[{type:"address",name:"",internalType:"address"}],stateMutability:"view"};async function g(e){try{return await f({contract:e,method:A})}catch{return}}export{y as resolveImplementation};
